# Pool service example environment
#
# This service:
# - Watches a Tron wallet's TRC-20 USDT balance.
# - When balance exceeds a threshold, requests a 1Click quote to swap Tron USDT -> Arbitrum USDT.
# - Transfers Tron USDT to the quote's `depositAddress` (optionally renting energy first).
# - Optionally submits the deposit tx hash back to 1Click to speed up processing.

# === Core Tron config (required) ===

# Tron gRPC endpoints (comma-separated), used with failover/rotation on errors.
# Example:
# TRON_GRPC_URLS=https://api.trongrid.io:50051,https://api.nileex.io:50051
TRON_GRPC_URLS=

# Optional Tron API key (sent as `tron-pro-api-key` gRPC metadata). Leave empty if not needed.
TRON_API_KEY=

# Private key for the watched/sending Tron account (32 bytes hex, with or without 0x prefix).
# This account will:
# - be polled for TRC-20 USDT balance
# - send USDT to the quote's deposit address
TRON_PRIVATE_KEY_HEX=

# Tron USDT TRC-20 contract address (Tron base58check "T..." OR 0x EVM-form).
# Default in code is Tron mainnet USDT:
# TRON_USDT_CONTRACT_ADDRESS=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t
TRON_USDT_CONTRACT_ADDRESS=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t

# === Pool job behavior ===

# Poll interval, in seconds.
POOL_POLL_INTERVAL_SECS=3

# Threshold for triggering a swap, as a decimal U256 in the token's smallest units.
# USDT has 6 decimals on Tron; so 10 USDT = 10_000_000.
# Note: the service keeps `POOL_USDT_BALANCE_KEEP_USDT` units in the wallet and swaps the rest.
POOL_USDT_BALANCE_THRESHOLD=10000000

# Amount of USDT to keep on the pool wallet after rebalancing, as a decimal U256 in the token's
# smallest units.
# USDT has 6 decimals on Tron; so 0.1 USDT = 100_000.
# Default in code: 1 (0.000001 USDT).
POOL_USDT_BALANCE_KEEP_USDT=1

# === 1Click / swap intent config (required) ===

# Base URL for the 1Click API.
ONECLICK_BASE_URL=https://1click.chaindefuser.com

# Bearer token for the 1Click API (sent as `Authorization: Bearer <token>`).
# If unset, requests are sent without auth.
ONECLICK_BEARER_TOKEN=

# Origin asset ID understood by 1Click. For Tron USDT, use the ID expected by 1Click (not the Tron contract address).
# Example (check 1Click tokens list if unsure):
# ONECLICK_ORIGIN_ASSET=nep141:tron-d28a265909efecdcee7c5028585214ea0b96f015.omft.near
ONECLICK_ORIGIN_ASSET=nep141:tron-d28a265909efecdcee7c5028585214ea0b96f015.omft.near

# Destination asset ID understood by 1Click. For Arbitrum USDT, use the ID expected by 1Click.
# Example:
# ONECLICK_DESTINATION_ASSET=nep141:arb-0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9.omft.near
ONECLICK_DESTINATION_ASSET=nep141:arb-0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9.omft.near

# Beneficiary address on the destination chain (Arbitrum) that receives the swapped USDT.
# Typically an EVM 0x address.
ONECLICK_BENEFICIARY=0xc6Ba8adBF3579607E23129a2D935de4E5bAEeCad

# Slippage tolerance in basis points (1 bp = 0.01%). Example: 100 = 1%.
ONECLICK_SLIPPAGE_BPS=100

# Quote deadline in seconds from "now" (RFC3339 deadline is computed internally).
ONECLICK_DEADLINE_SECS=900

# Optional referral identifier, if you have one.
ONECLICK_REFERRAL=

# Poll 1Click execution status in the background for each deposit address we send to.
ONECLICK_STATUS_POLL_INTERVAL_SECS=10

# How long to keep polling before logging a timeout warning and giving up.
ONECLICK_STATUS_MAX_WAIT_SECS=1800

# Cooldown/backoff when 1Click reports failures/refunds/timeouts (to avoid repeatedly paying energy).
# Backoff is exponential: base * 2^(streak-1), capped at max.
ONECLICK_BACKOFF_BASE_SECS=60
ONECLICK_BACKOFF_MAX_SECS=3600

# === Tron fee/rental tuning (optional) ===

# Hard cap for the transaction `fee_limit` (sun). Default: 30 TRX.
# Note: 1 TRX = 1_000_000 sun.
TRON_FEE_LIMIT_CAP_SUN=30000000

# Extra headroom for fee_limit calculation, in parts-per-million (ppm). Default: 100_000 (+10%).
# Range: 0..=1_000_000
TRON_FEE_LIMIT_HEADROOM_PPM=100000

# Optional JSON config for external energy rental providers.
# This is a JSON array of provider configs consumed by `tron::JsonApiRentalProvider`.
# When enabled, the service will estimate energy required, compare to account's available energy,
# and attempt to rent the shortfall before broadcasting the tx (best-effort).
#
# After a successful rental response, the service polls (with backoff) for up to this duration
# for the rented energy to be reflected in `getaccountresource`, then broadcasts.
TRON_ENERGY_RENTAL_SETTLE_DELAY_SECS=6
#
# Example:
# TRON_ENERGY_RENTAL_APIS_JSON='[
#   {
#     "name":"provider1",
#     "url":"https://rental.example/api/rent",
#     "method":"POST",
#     "headers":{"Authorization":"Bearer {{YOUR_TOKEN}}"},
#     "body":{
#       "kind":"{{resource_kind}}",
#       "amount":"{{amount}}",
#       "address":"{{address_base58check}}",
#       "txid":"{{txid}}"
#     },
#     "response":{
#       "success_pointer":"/ok",
#       "error_pointer":"/error",
#       "order_id_pointer":"/orderId"
#     }
#   }
# ]'
TRON_ENERGY_RENTAL_APIS_JSON=

# === Observability (optional, shared across services) ===

# Disable OTLP exporters entirely (keeps logging).
# OTEL_DISABLED=true
OTEL_DISABLED=

# Trace sampling ratio in [0.0, 1.0]. Default: 0.01
# OTEL_TRACES_SAMPLE_RATIO=0.05
OTEL_TRACES_SAMPLE_RATIO=

# Optional tags commonly used by our observability setup.
DEPLOYMENT_ENV=
HOSTNAME=
